Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v4, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Obtaining file:///lustre03/project/6086105/ymbahram/improved_diffusion/SDFT
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: blobfile>=1.0.5 in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from improved-diffusion==0.0.0) (2.1.1)
Requirement already satisfied: torch in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from improved-diffusion==0.0.0) (2.3.1+computecanada)
Requirement already satisfied: tqdm in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from improved-diffusion==0.0.0) (4.66.4+computecanada)
Requirement already satisfied: pycryptodomex~=3.8 in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from blobfile>=1.0.5->improved-diffusion==0.0.0) (3.19.0+computecanada)
Requirement already satisfied: urllib3<3,>=1.25.3 in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from blobfile>=1.0.5->improved-diffusion==0.0.0) (2.2.1)
Requirement already satisfied: lxml~=4.9 in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from blobfile>=1.0.5->improved-diffusion==0.0.0) (4.9.2+computecanada)
Requirement already satisfied: filelock~=3.0 in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from blobfile>=1.0.5->improved-diffusion==0.0.0) (3.13.1+computecanada)
Requirement already satisfied: typing-extensions>=4.8.0 in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from torch->improved-diffusion==0.0.0) (4.11.0+computecanada)
Requirement already satisfied: sympy in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from torch->improved-diffusion==0.0.0) (1.12+computecanada)
Requirement already satisfied: networkx in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from torch->improved-diffusion==0.0.0) (3.3+computecanada)
Requirement already satisfied: jinja2 in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from torch->improved-diffusion==0.0.0) (3.1.4+computecanada)
Requirement already satisfied: fsspec in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from torch->improved-diffusion==0.0.0) (2024.3.1+computecanada)
Requirement already satisfied: numpy<2.0,>=1.26 in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from torch->improved-diffusion==0.0.0) (1.26.4+computecanada)
Requirement already satisfied: MarkupSafe>=2.0 in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from jinja2->torch->improved-diffusion==0.0.0) (2.1.3+computecanada)
Requirement already satisfied: mpmath>=0.19 in /lustre03/project/6086105/ymbahram/gputorch/lib/python3.10/site-packages (from sympy->torch->improved-diffusion==0.0.0) (1.3.0+computecanada)
Installing collected packages: improved-diffusion
  Attempting uninstall: improved-diffusion
    Found existing installation: improved-diffusion 0.0.0
    Uninstalling improved-diffusion-0.0.0:
      Successfully uninstalled improved-diffusion-0.0.0
  Running setup.py develop for improved-diffusion
Successfully installed improved-diffusion-0.0.0
********************
lambda_auxs: [0, 0.1, 0.3, 1], gamma_aux: 9999, gamma_distil: 999
********************
********************
fixed guidance is 0
********************
0it [00:00, ?it/s]/lustre03/project/6086105/ymbahram/improved_diffusion/SDFT/improved_diffusion/gaussian_diffusion.py:876: RuntimeWarning: overflow encountered in power
  weight_aux = _extract_into_tensor(1 / (self.p2_k + self.snr)**self.gamma_aux, t, target.shape)
/lustre03/project/6086105/ymbahram/improved_diffusion/SDFT/improved_diffusion/gaussian_diffusion.py:876: RuntimeWarning: divide by zero encountered in divide
  weight_aux = _extract_into_tensor(1 / (self.p2_k + self.snr)**self.gamma_aux, t, target.shape)
0it [00:01, ?it/s]
Traceback (most recent call last):
  File "/home/ymbahram/projects/def-hadi87/ymbahram/improved_diffusion/SDFT/scripts/finetuning_samesample_SDFT_aux.py", line 224, in <module>
    ).run_loop()
  File "/lustre03/project/6086105/ymbahram/improved_diffusion/SDFT/improved_diffusion/train_util.py", line 195, in run_loop
    self.run_step(batch, cond) 
  File "/lustre03/project/6086105/ymbahram/improved_diffusion/SDFT/improved_diffusion/train_util.py", line 213, in run_step
    self.forward_backward(batch, cond)  
  File "/lustre03/project/6086105/ymbahram/improved_diffusion/SDFT/improved_diffusion/train_util.py", line 259, in forward_backward
    losses = compute_losses()
  File "/lustre03/project/6086105/ymbahram/improved_diffusion/SDFT/improved_diffusion/respace.py", line 96, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/lustre03/project/6086105/ymbahram/improved_diffusion/SDFT/improved_diffusion/gaussian_diffusion.py", line 879, in training_losses
    terms["loss"] += self.lambda_aux * terms["L_aux"]
TypeError: only integer tensors of a single element can be converted to an index
